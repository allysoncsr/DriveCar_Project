{% extends 'drivecar/base.html' %}
{% load form_extras %}
{% block title %}Manuten√ß√£o - {{ veiculo }}{% endblock %}
{% block content %}
<h2>Manuten√ß√£o ‚Äî {{ veiculo }}</h2>

<!-- Busca R√°pida de Pe√ßas -->
<div class="busca-rapida">
  <div class="busca-container">
    <input type="text" 
           id="busca-peca" 
           placeholder="üîç Buscar pe√ßa..." 
           class="busca-input"
           autocomplete="off">
    <div id="resultados-busca" class="resultados-busca"></div>
  </div>
</div>

<div class="categorias">
  {% for categoria, pecas in categorias.items %}
    <section class="categoria {% if categoria in categorias_com_alerta %}categoria-com-alerta categoria-alerta-{{ categorias_tipo_alerta|get_item:categoria }}{% endif %}">
      <button type="button" class="categoria-toggle" data-target="#categoria-{{ forloop.counter }}" aria-expanded="false">
        <span class="categoria-title">{{ categoria }}</span>
        <div class="categoria-badges">
          <span class="categoria-count {% if categoria in categorias_com_alerta %}alerta-{{ categorias_tipo_alerta|get_item:categoria }}{% endif %}">{{ pecas|length }}</span>
        </div>
      </button>

      <div id="categoria-{{ forloop.counter }}" class="categoria-body collapse">
        <ul>
          {% for p in pecas %}
            <li class="peca-item {% if p.id in pecas_com_alerta %}peca-com-alerta{% endif %}">
              <a href="{% url 'drivecar:registros_peca' veiculo.id p.id %}" class="peca-link" data-target="#registros-{{ p.id }}">
                {{ p.nome }}
                {% if p.id in pecas_com_alerta %}
                  <span class="alerta-indicator">‚ö†Ô∏è</span>
                {% endif %}
              </a>
              <div id="registros-{{ p.id }}" class="peca-registros collapse"></div>
            </li>
          {% endfor %}
        </ul>
      </div>
    </section>
  {% endfor %}
</div>

<!-- JS de accordion movido para static/js/main.js?v=5 -->

{% endblock %}
